<!DOCTYPE html><html lang="ja" class="scroll-smooth"> <head><meta charset="UTF-8"><meta name="description" content="ã§ã°ãŒã‚ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆ"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.16.3"><title>ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ (ç®¡ç†è€…) - ãƒ¬ãƒ¼ãƒ³é˜²è¡›Ver</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/debagame-homepage/_astro/ClientRouter.astro_astro_type_script_index_0_lang.QW52Ox2j.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZDEY5ZH97E"></script><script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			// Initial tracking is handled by astro:page-load to support View Transitions
			document.addEventListener('astro:page-load', () => {
				gtag('config', 'G-ZDEY5ZH97E', {
					page_path: window.location.pathname,
				});
			});
		</script><link rel="stylesheet" href="/debagame-homepage/_astro/index.B4RrG8ig.css">
<style>.slider-group{display:flex;align-items:center;gap:8px;margin-bottom:6px}.slider-group label{font-size:11px;color:#94a3b8;min-width:90px;text-align:right}.slider-group input[type=range]{flex:1;accent-color:#3b82f6;height:4px;cursor:pointer}.slider-group .val{font-size:10px;color:#64748b;min-width:35px;text-align:center;font-family:monospace}.color-input{width:28px;height:20px;border:1px solid #475569;border-radius:4px;cursor:pointer;padding:0;background:none}.section-title{font-size:11px;font-weight:800;color:#60a5fa;border-bottom:1px solid #334155;padding-bottom:4px;margin-bottom:8px;margin-top:12px;letter-spacing:.05em}.motion-btn{padding:4px 10px;font-size:10px;font-weight:700;border-radius:6px;cursor:pointer;border:2px solid transparent;transition:all .15s;white-space:nowrap}.motion-btn:hover{transform:scale(1.05)}.motion-btn.active{border-color:#3b82f6;box-shadow:0 0 12px #3b82f666}.panel{background:#0f172a;border:1px solid #1e293b;border-radius:8px;padding:12px}.tab-btn-d{padding:4px 12px;font-size:11px;font-weight:700;border-radius:6px;cursor:pointer;transition:all .15s;background:#1e293b;color:#64748b}.tab-btn-d.active{background:#3b82f6;color:#fff;box-shadow:0 0 10px #3b82f64d}#designer-panel::-webkit-scrollbar{width:4px}#designer-panel::-webkit-scrollbar-thumb{background:#334155;border-radius:4px}.no-scrollbar::-webkit-scrollbar{display:none}.target-toggle{display:flex;gap:4px;background:#1e293b;padding:4px;border-radius:8px;margin-bottom:12px;overflow-x:auto}.target-btn{flex:1;padding:6px 12px;font-size:10px;font-weight:800;border-radius:6px;cursor:pointer;transition:.2s;text-align:center;white-space:nowrap}.target-btn.active{background:#3b82f6;color:#fff}.target-btn:not(.active){color:#64748b;background:#0f172a}
.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}:root{--accent: 136, 58, 234;--accent-light: 224, 204, 250;--accent-dark: 49, 10, 101;--accent-gradient: linear-gradient( 45deg, rgb(var(--accent)), rgb(var(--accent-light)) 30%, white 60% )}
</style></head> <body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col font-sans"> <aside id="sidebar" class="fixed top-0 left-0 z-50 w-64 h-screen transition-transform -translate-x-full bg-white border-r border-gray-200 dark:bg-gray-800 dark:border-gray-700 shadow-lg" aria-label="Sidebar"> <div class="h-full px-3 py-4 overflow-y-auto bg-gray-50 dark:bg-gray-800 flex flex-col"> <div class="flex justify-between items-center mb-6 px-2"> <h2 class="text-xl font-bold text-gray-800 dark:text-white">Menu</h2> <button id="close-sidebar" class="text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2"> <svg class="w-6 h-6" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path> </svg> <span class="sr-only">Close menu</span> </button> </div> <ul class="space-y-2 font-medium"> <li> <a href="/debagame-homepage" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <svg class="w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 22 21"> <path d="M16.975 11H10V4.025a1 1 0 0 0-1.066-.998 8.5 8.5 0 1 0 9.039 9.039.999.999 0 0 0-1-1.066h.002Z"></path> <path d="M12.5 0c-.157 0-.311.01-.565.027A1 1 0 0 0 11 1.02V10h8.975a1 1 0 0 0 1-.935c.013-.188.028-.374.028-.565A8.51 8.51 0 0 0 12.5 0Z"></path> </svg> <span class="ms-3">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸</span> </a> </li> <li class="pt-4 mt-4 space-y-2 border-t border-gray-200 dark:border-gray-700"> <div class="px-2 text-xs font-semibold text-gray-500 uppercase dark:text-gray-400">Contents</div> </li> <li> <a href="/debagame-homepage/ai-timeline" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> â„¹ï¸ </span> <span class="ms-3">AIå¹´è¡¨</span> </a> </li><li> <a href="/debagame-homepage/game/chinchiro" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ® </span> <span class="ms-3">ç„¡é™ãƒãƒ³ãƒãƒ­</span> </a> </li><li> <a href="/debagame-homepage/game/xylophone" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ® </span> <span class="ms-3">æœ¨ç´ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿</span> </a> </li><li> <a href="/debagame-homepage/tool/size-check" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ› ï¸ </span> <span class="ms-3">æœã®ã‚µã‚¤ã‚ºæ¤œè¨</span> </a> </li><li> <a href="/debagame-homepage/dashboard/health" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ“Š </span> <span class="ms-3">å¥åº·è¨ºæ–­ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span> </a> </li><li> <a href="/debagame-homepage/dashboard/bear" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ“Š </span> <span class="ms-3">ç†Šè¢«å®³çŠ¶æ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span> </a> </li><li> <a href="/debagame-homepage/info/world-map" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> â„¹ï¸ </span> <span class="ms-3">ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ä¸–ç•Œåœ°å›³</span> </a> </li><li> <a href="/debagame-homepage/info/number-plate" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> â„¹ï¸ </span> <span class="ms-3">ãƒŠãƒ³ãƒãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆæƒ…å ±</span> </a> </li><li> <a href="/debagame-homepage/game/pc-break" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ® </span> <span class="ms-3">PCç ´å£Šã‚²ãƒ¼ãƒ  2025</span> </a> </li><li> <a href="/debagame-homepage/game/lane-defense" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ® </span> <span class="ms-3">ãƒŸãƒ‹ãƒãƒ ç„¡åŒ - ãƒ¬ãƒ¼ãƒ³é˜²è¡›Ver</span> </a> </li><li> <a href="/debagame-homepage/info/anime-timeline" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> â„¹ï¸ </span> <span class="ms-3">æ—¥æœ¬ã‚¢ãƒ‹ãƒ¡æ˜ ç”»å²å¹´è¡¨</span> </a> </li><li> <a href="/debagame-homepage/tool/length-visualizer" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center"> ğŸ› ï¸ </span> <span class="ms-3">é•·ã•å˜ä½ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¶ãƒ¼</span> </a> </li> </ul> <div class="mt-auto pt-4 border-t border-gray-200 dark:border-gray-700"> <a href="/debagame-homepage/admin/" class="flex items-center p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group transition-colors"> <span class="flex-shrink-0 w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white flex items-center justify-center">
â„¹ï¸
</span> <span class="ms-3">èŠ¸äººå¹´è¡¨ï¼ˆç®¡ç†ï¼‰</span> </a> </div> </div> </aside> <div id="sidebar-overlay" class="fixed inset-0 bg-gray-900/50 z-40 hidden backdrop-blur-sm transition-opacity" aria-hidden="true"></div> <script type="module">function s(){const t=document.getElementById("sidebar"),d=document.getElementById("sidebar-overlay"),o=document.getElementById("close-sidebar"),a=document.querySelectorAll(".sidebar-toggle");function i(){t?.classList.remove("-translate-x-full"),d?.classList.remove("hidden"),document.body.classList.add("overflow-hidden")}function e(){t?.classList.add("-translate-x-full"),d?.classList.add("hidden"),document.body.classList.remove("overflow-hidden")}o?.addEventListener("click",e),d?.addEventListener("click",e),a.forEach(n=>{n.addEventListener("click",c=>{c.stopPropagation(),t?.classList.contains("-translate-x-full")?i():e()})}),document.addEventListener("keydown",n=>{n.key==="Escape"&&e()})}s();document.addEventListener("astro:page-load",s);</script>  <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50"> <div class="container mx-auto px-4 h-16 flex items-center justify-between"> <div class="flex items-center gap-2"> <div class="w-8 h-8 bg-blue-600 rounded flex items-center justify-center text-white font-bold">
&lt;/&gt;
</div> <h1 class="font-bold text-xl tracking-tight"> <a href="/debagame-homepage" class="hover:text-blue-600 transition-colors">ã§ã°ãŒã‚ã®ã»ã‚ã±ã’</a> </h1> </div> <button class="sidebar-toggle p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg> </button> </div> </header> <main class="flex flex-col w-full h-[calc(100vh-64px)] overflow-hidden bg-gray-900 text-white font-sans">  <!-- ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³é¸æŠ --> <div class="flex gap-2 px-4 py-2 bg-gray-950 border-b border-gray-800 flex-wrap items-center"> <div class="flex items-center gap-2"> <span class="text-[10px] text-blue-500 font-black tracking-tighter">ADMIN TRAINER v4</span> <div class="h-4 w-[1px] bg-gray-700 mx-1"></div> </div> <div class="flex gap-1 overflow-x-auto no-scrollbar items-center" id="motion-selector"> <button class="motion-btn bg-purple-900/50 text-purple-300 active" data-motion="base">ğŸ—ï¸ ç´ ä½“</button> <div class="w-[2px] h-4 bg-gray-800 mx-1"></div> <button class="motion-btn bg-gray-800 text-gray-400" data-motion="idle">ğŸ§ å¾…æ©Ÿ</button> <button class="motion-btn bg-gray-800 text-gray-400" data-motion="walk">ğŸš¶ æ­©è¡Œ</button> <div class="w-[2px] h-4 bg-gray-800 mx-1"></div> <button class="motion-btn bg-blue-900/50 text-blue-300" data-motion="weak">âš”ï¸ å¼±æ”»æ’ƒ</button> <button class="motion-btn bg-red-900/50 text-red-300" data-motion="front-wide">ğŸŒ€ ã‚¹ã‚¦ã‚£ãƒ¼ãƒ—</button> <button class="motion-btn bg-cyan-900/50 text-cyan-300" data-motion="pierce">ğŸ’  çªã</button> <button class="motion-btn bg-yellow-900/50 text-yellow-300" data-motion="grandcross">âœ¨ è–åå­—</button> </div> <div class="ml-auto flex items-center gap-2 text-[10px] text-gray-500 italic"> <span>ğŸ–±ï¸ å·¦ã‚¿ãƒƒãƒ—: å¼± / ğŸ–±ï¸ å³ã‚¹ãƒ¯ã‚¤ãƒ—: å¼·</span> </div> </div> <div class="flex flex-1 min-h-0 overflow-hidden"> <!-- å·¦: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ --> <div class="flex-1 flex flex-col bg-gray-900 relative"> <div class="flex items-center gap-2 p-3 bg-gray-900 border-b border-gray-800 shadow-xl z-10"> <span class="text-xs font-bold text-blue-400" id="current-target-label">EDITING: PLAYER</span> <div class="flex gap-1 ml-auto"> <button id="btn-zoom-out" class="text-xs bg-gray-800 hover:bg-gray-700 px-3 py-1 rounded">-</button> <span id="zoom-label" class="text-[10px] text-blue-400 font-mono flex items-center px-1">200%</span> <button id="btn-zoom-in" class="text-xs bg-gray-800 hover:bg-gray-700 px-3 py-1 rounded">+</button> <button id="btn-toggle-grid" class="text-[10px] font-bold bg-gray-800 hover:bg-gray-700 px-3 py-1 rounded ml-2">GRID</button> </div> </div> <div class="flex-1 flex items-center justify-center overflow-hidden bg-[radial-gradient(circle_at_center,_#1e293b_0%,_#0f172a_100%)] relative cursor-crosshair" id="canvas-wrap"> <canvas id="preview-canvas" width="800" height="600"></canvas> <!-- èƒŒæ™¯ç›®å®‰ --> <div class="absolute bottom-10 left-0 right-0 h-[100px] border-t border-blue-900/30 bg-blue-900/5 pointer-events-none"></div> </div> </div> <!-- å³: èª¿æ•´ãƒ‘ãƒãƒ« --> <div id="designer-panel" class="w-[360px] bg-gray-950 border-l border-gray-800 overflow-y-auto p-4 flex flex-col gap-4 shadow-2xl"> <!-- ç·¨é›†å¯¾è±¡ãƒˆã‚°ãƒ« (4ã‚¿ã‚¤ãƒ—) --> <div class="target-toggle no-scrollbar"> <div class="target-btn active" data-target="player">PLAYER</div> <div class="target-btn" data-target="enemy1">ENEMY 1</div> <div class="target-btn" data-target="enemy2">ENEMY 2</div> <div class="target-btn" data-target="boss">BOSS</div> </div> <!-- ç®¡ç†è€…å‘ã‘ã‚¿ãƒ– --> <div class="flex gap-1 p-1 bg-gray-900 rounded-lg"> <button class="tab-btn-d active flex-1" data-panel="skeleton">é€ å½¢</button> <button class="tab-btn-d flex-1" data-panel="joints">é–¢ç¯€/è©³ç´°</button> <button class="tab-btn-d flex-1" data-panel="export">åæ˜ </button> </div> <!-- é€ å½¢ãƒ‘ãƒãƒ« (ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã‚ˆã£ã¦è¡¨ç¤ºé …ç›®ãŒå¤‰ã‚ã‚‹) --> <div id="panel-skeleton" class="panel space-y-3"> <div id="skel-common"> <div class="section-title">ğŸ“ åŸºæœ¬ã‚¹ã‚±ãƒ¼ãƒ«</div> <div class="slider-group"><label>å…¨ä½“</label><input type="range" id="p-scale" min="0.5" max="4" step="0.1" value="1.5"><span class="val" id="v-scale">1.5</span></div> <div class="section-title">ğŸ¨ ã‚«ãƒ©ãƒ¼</div> <div class="flex gap-2 items-center flex-wrap"> <label class="text-[10px] text-gray-500">ä¸»è‰²</label> <input type="color" id="pc-body" value="#3b82f6" class="color-input"> <label class="text-[10px] text-gray-500 ml-2">å‰¯è‰²/é ­</label> <input type="color" id="pc-head" value="#1e3a5f" class="color-input"> </div> </div> <div id="skel-humanoid" class=""> <div class="section-title">ğŸ‘¥ äººå‹ãƒ‘ãƒ¼ãƒ„å¯¸æ³•</div> <div class="slider-group"><label>é ­éƒ¨ å¹…</label><input type="range" id="p-headW" min="8" max="32" step="1" value="14"><span class="val" id="v-headW">14</span></div> <div class="slider-group"><label>èƒ´ä½“ ç¸¦</label><input type="range" id="p-torsoH" min="10" max="60" step="1" value="24"><span class="val" id="v-torsoH">24</span></div> <div class="slider-group"><label>è…•ã®é•·ã•</label><input type="range" id="p-upperArmLen" min="4" max="30" step="1" value="10"><span class="val" id="v-upperArmLen">10</span></div> <div class="slider-group"><label>è„šã®é•·ã•</label><input type="range" id="p-upperLegLen" min="4" max="30" step="1" value="12"><span class="val" id="v-upperLegLen">12</span></div> </div> <div id="skel-classic" class="hidden"> <div class="section-title">âš™ï¸ ã‚¯ãƒ©ã‚·ãƒƒã‚¯å½¢çŠ¶è¨­å®š</div> <div class="slider-group"><label>åŸºæœ¬ã‚µã‚¤ã‚º</label><input type="range" id="p-size" min="5" max="40" step="1" value="12"><span class="val" id="v-size">12</span></div> <div class="slider-group"><label>ä¸é€æ˜åº¦</label><input type="range" id="p-shadowAlpha" min="0" max="1" step="0.1" value="0.3"><span class="val" id="v-shadowAlpha">0.3</span></div> </div> </div> <!-- é–¢ç¯€/è©³ç´°ãƒ‘ãƒãƒ« --> <div id="panel-joints" class="panel hidden space-y-3"> <div id="joints-humanoid"> <div class="section-title">ğŸ“ è‚©ãƒ”ãƒœãƒƒãƒˆä½ç½®</div> <div class="slider-group"><label>è‚© X</label><input type="range" id="p-shoulderX" min="0" max="30" step="1" value="10"><span class="val" id="v-shoulderX">10</span></div> <div class="slider-group"><label>è‚© Y</label><input type="range" id="p-shoulderY" min="-20" max="20" step="1" value="-10"><span class="val" id="v-shoulderY">-10</span></div> <div class="section-title">ğŸ“ è‚¡ãƒ”ãƒœãƒƒãƒˆä½ç½®</div> <div class="slider-group"><label>è‚¡ X</label><input type="range" id="p-hipX" min="0" max="20" step="1" value="5"><span class="val" id="v-hipX">5</span></div> <div class="slider-group"><label>è‚¡ Y</label><input type="range" id="p-hipY" min="-10" max="20" step="1" value="10"><span class="val" id="v-hipY">10</span></div> </div> <div id="joints-classic" class="hidden"> <p class="text-[10px] text-gray-500 italic">ã‚¯ãƒ©ã‚·ãƒƒã‚¯å½¢çŠ¶ã«ã¯é–¢ç¯€è¨­å®šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚é€ å½¢ã‚¿ãƒ–ã§è‰²ã‚„ã‚µã‚¤ã‚ºã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚</p> </div> </div> <!-- ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³èª¿æ•´ãƒ‘ãƒãƒ« (å„ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³é¸æŠæ™‚ã«è¡¨ç¤º) --> <div id="panel-motion" class="panel hidden space-y-3"> <div id="motion-idle" class="motion-subpanel hidden"> <div class="section-title">ğŸ§ å¾…æ©Ÿãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³èª¿æ•´</div> <div class="slider-group"><label>å‘¼å¸å‘¨æœŸ(ms)</label><input type="range" id="m-idle-breathSpeed" min="100" max="1000" step="10" value="300"><span class="val" id="vm-idle-breathSpeed">300</span></div> <div class="slider-group"><label>æºã‚Œå¹…</label><input type="range" id="m-idle-breathAmount" min="0" max="5" step="0.1" value="1.5"><span class="val" id="vm-idle-breathAmount">1.5</span></div> </div> <div id="motion-walk" class="motion-subpanel hidden"> <div class="section-title">ğŸš¶ æ­©è¡Œãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³èª¿æ•´</div> <div class="slider-group"><label>æ­©è¡Œå‘¨æœŸ</label><input type="range" id="m-walk-walkSpeed" min="50" max="300" step="5" value="120"><span class="val" id="vm-walk-walkSpeed">120</span></div> <div class="slider-group"><label>è¶³ã®æŒ¯ã‚Šå¹…</label><input type="range" id="m-walk-walkAmplitude" min="0.1" max="1.5" step="0.1" value="0.8"><span class="val" id="vm-walk-walkAmplitude">0.8</span></div> </div> <div id="motion-attack" class="motion-subpanel hidden"> <div class="section-title">âš”ï¸ æ”»æ’ƒå‹•ä½œèª¿æ•´</div> <div class="slider-group"><label>å‹•ä½œé€Ÿåº¦</label><input type="range" id="m-attack-speed" min="0.5" max="3" step="0.1" value="1.0"><span class="val" id="vm-attack-speed">1.0</span></div> <div id="attack-extra-weak"> <div class="slider-group"><label>ã‚¹ã‚¤ãƒ³ã‚°è§’</label><input type="range" id="m-weak-arc" min="0.5" max="3.0" step="0.1" value="2.0"><span class="val" id="vm-weak-arc">2.0</span></div> </div> <div id="attack-extra-grand" class="hidden"> <div class="slider-group"><label>å…‰ã®å¤§ãã•</label><input type="range" id="m-grand-glow" min="5" max="50" step="1" value="20"><span class="val" id="vm-grand-glow">20</span></div> </div> </div> </div> <!-- å‡ºåŠ›ãƒ‘ãƒãƒ« --> <div id="panel-export" class="panel hidden"> <div class="section-title">ğŸ’¾ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåæ˜ </div> <p class="text-[10px] text-gray-400 mb-3 leading-relaxed">
ç¾åœ¨ã®èª¿æ•´ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ã®ã¿ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚<br> <strong>ã€Œã“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’æ­£å¼æ¡ç”¨ã—ã¦ï¼ã€</strong>ã¨AIã«ä¼ãˆã‚‹ã¨ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆGitï¼‰ã‚’æ›¸ãæ›ãˆã¦å…¨å“¡ã«åæ˜ ã—ã¾ã™ã€‚
</p> <button id="btn-copy-config" class="w-full bg-blue-600 hover:bg-blue-500 text-white py-2 rounded font-bold text-xs shadow-lg transition-all active:scale-95">å€‹åˆ¥è¨­å®šã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼</button> <div id="copy-status" class="text-center text-[10px] mt-2 opacity-0 text-green-400">COPIED!</div> <textarea id="config-json" class="w-full h-32 bg-gray-900 border border-gray-800 rounded mt-2 p-2 font-mono text-[9px] text-gray-400 no-scrollbar" readonly></textarea> <div class="section-title mt-6">âš ï¸ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</div> <button id="btn-reset" class="w-full bg-transparent border border-red-900/50 hover:bg-red-900/20 text-red-500 py-2 rounded font-bold text-[10px] transition-all">ã“ã®ã‚­ãƒ£ãƒ©ã‚’åˆæœŸå€¤ã«æˆ»ã™</button> </div> </div> </div> </main>  </body></html> <script>
const canvas = document.getElementById('preview-canvas');
const ctx = canvas.getContext('2d');
let zoom = 2.0;
let showGrid = true;
let currentMotion = 'idle';
let editTarget = 'player'; // 'player', 'enemy1', 'enemy2', 'boss'

// â”€â”€ è¨­å®šãƒ‡ãƒ¼ã‚¿ç¾¤ (4ä½“åˆ†) â”€â”€
const DEFAULTS = {
    player: {
        scale: 1.5, headW: 14, headH: 14, torsoW: 16, torsoH: 24,
        upperArmW: 4, upperArmLen: 10, lowerArmW: 4, lowerArmLen: 10,
        upperLegW: 4, upperLegLen: 12, lowerLegW: 4, lowerLegLen: 12,
        shoulderX: 10, shoulderY: -10, hipX: 5, hipY: 10,
        elbowAngle: 0.5, kneeAngle: 0.2, 
        shadowAlpha: 0.3,
        cBody: '#3b82f6', cHead: '#1e3a5f', cEye: '#38bdf8', cArms: '#2563eb', cLegs: '#1e40af',
        motions: {
            idle: { breathSpeed: 350, breathAmount: 0.8 },
            walk: { walkSpeed: 450, walkAmplitude: 0.8 },
            attack: { speed: 1.0, weakArc: 2.0, grandGlow: 20 }
        }
    },
    enemy1: {
        scale: 1.0, size: 12, color: '#ef4444', shape: 'circle', shadowAlpha: 0.3,
        cBody: '#ef4444', cHead: '#fff' 
    },
    enemy2: {
        scale: 1.0, size: 18, color: '#b91c1c', shape: 'rect', shadowAlpha: 0.3,
        cBody: '#b91c1c', cHead: '#fef08a'
    },
    boss: {
        scale: 2.0, headW: 24, headH: 22, torsoW: 32, torsoH: 36,
        upperArmW: 6, upperArmLen: 14, lowerArmW: 6, lowerArmLen: 12,
        upperLegW: 6, upperLegLen: 14, lowerLegW: 6, lowerLegLen: 12,
        shoulderX: 18, shoulderY: -12, hipX: 10, hipY: 12,
        elbowAngle: 0.3, kneeAngle: 0.3, 
        cBody: '#ef4444', cHead: '#7f1d1d', cEye: '#facc15', cArms: '#991b1b', cLegs: '#7f1d1d', shadowAlpha: 0.4,
        motions: {
            idle: { breathSpeed: 250, breathAmount: 0.8 },
            walk: { walkSpeed: 400, walkAmplitude: 1.0 },
            attack: { speed: 0.8, weakArc: 1.5, grandGlow: 30 }
        }
    }
};

let CONFIGS = {
    player: { ...DEFAULTS.player },
    enemy1: { ...DEFAULTS.enemy1 },
    enemy2: { ...DEFAULTS.enemy2 },
    boss: { ...DEFAULTS.boss }
};

// â”€â”€ localStorage ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰ â”€â”€
const TARGET_KEYS = {
    player: 'lane_defense_character_config',
    enemy1: 'lane_defense_enemy1_config',
    enemy2: 'lane_defense_enemy2_config',
    boss: 'lane_defense_boss_config'
};

function loadAllConfigs() {
    for (let target in TARGET_KEYS) {
        try {
            const saved = localStorage.getItem(TARGET_KEYS[target]);
            if (saved) {
                const parsed = JSON.parse(saved);
                // æ—¢å­˜ã®ã‚­ãƒ¼ã‚’ãƒãƒ¼ã‚¸ï¼ˆNaNé˜²æ­¢ï¼‰
                for (let k in parsed) {
                    if (CONFIGS[target][k] !== undefined) CONFIGS[target][k] = parsed[k];
                }
            }
        } catch(e) {}
    }
}
loadAllConfigs();

function saveToLocal(target) {
    localStorage.setItem(TARGET_KEYS[target], JSON.stringify(CONFIGS[target]));
}

// â”€â”€ çŠ¶æ…‹ç®¡ç† (Training) â”€â”€
const STATE = {
    player: { x: 300, y: 450, attackType: null, attackCooldown: 0, lastMaxCooldown: 0 },
    enemy: { x: 500, y: 450, knockback: 0, lastHitTime: 0 },
    particles: []
};

// â”€â”€ æç”»ãƒ­ã‚¸ãƒƒã‚¯ â”€â”€

// ğŸ¨ è‰²èª¿èª¿æ•´ãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ æç”»ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆã«å¿…é ˆï¼ï¼‰
function adjustColor(hex, amt) {
    let col = hex.replace('#','');
    let r = parseInt(col.substring(0,2),16), g = parseInt(col.substring(2,4),16), b = parseInt(col.substring(4,6),16);
    r = Math.max(0, Math.min(255, r + amt)); g = Math.max(0, Math.min(255, g + amt)); b = Math.max(0, Math.min(255, b + amt));
    return `#${(r<<16 | g<<8 | b).toString(16).padStart(6,'0')}`;
}

function drawEntity(ctx, x, y, target, motion, time, ad) {
    const C = CONFIGS[target];
    if (!C) return;
    const s = (C.scale || 1) * zoom/2;
    const m = (C.motions || DEFAULTS.player.motions);
    
    ctx.save();
    ctx.translate(x, y);
    
    const isAttacking = ad && ad.cooldown > 0;
    
    // ğŸ§ ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—
    let breath = 0;
    let walkCycle = 0;
    let bounce = 0;
    let armSwing = 0;
    
    if (motion === 'walk' && !isAttacking) {
        const walkSpeed = (m.walk.walkSpeed / 1000) * 1.2;
        const phase = (time * walkSpeed) % (Math.PI * 2);
        
        // æ¥åœ°æ„Ÿã®ã‚ã‚‹æ­©è¡Œãƒ­ã‚¸ãƒƒã‚¯ (ã„ã¡ã«ã€ã®ãƒªã‚ºãƒ )
        // è¶³ã®å‹•ã: åœ°é¢ã‚’è¹´ã‚‹æ™‚ã¯ç›´ç·šçš„ã«å¾Œã‚ã¸ã€ä¸Šã’ã‚‹æ™‚ã¯å¼§ã‚’æã
        walkCycle = Math.sin(phase) * m.walk.walkAmplitude;
        
        // é‡å¿ƒã®ä¸Šä¸‹å‹• (Bounce): è¶³ãŒå…¥ã‚Œæ›¿ã‚ã‚‹ç¬é–“ã«å°‘ã—ä¸ŠãŒã‚Šã€è¸ã¿è¾¼ã‚€ç¬é–“ã«æ²ˆã‚€
        // Math.abs(sin) ã§ 2å‘¨æœŸä½œã‚Šã€æ¥åœ°æ„Ÿã‚’å‡ºã™
        bounce = Math.abs(Math.sin(phase)) * 4 * s;
        armSwing = -walkCycle * 0.8;
    } else if (!isAttacking) {
        // å¾…æ©Ÿ: è†ã‚’è½ã¨ã—ã¦æ§‹ãˆãªãŒã‚‰å‘¼å¸ï¼ˆæµ®éŠã§ã¯ãªãåœ°ã«è¶³ã®ã¤ã„ãŸæ§‹ãˆï¼‰
        const idlePhase = time / m.idle.breathSpeed;
        breath = Math.sin(idlePhase) * m.idle.breathAmount * s; // èƒ´ä½“ã®å¾®ã‹ãªä¸Šä¸‹
        bounce = -(2 + Math.sin(idlePhase) * 1.5) * s; // è†ã‚’è½ã¨ã—ã¦æ²ˆã¿è¾¼ã‚€ï¼ˆè² å€¤=ä¸‹æ–¹å‘ï¼‰
        armSwing = Math.sin(idlePhase * 0.7) * 0.15; // æ§‹ãˆã®è…•ã®å¾®æºã‚Œ
    }

    // å½± (Ground Shadow)
    ctx.fillStyle = `rgba(0,0,0,${(C.shadowAlpha || 0.3) * 0.8})`;
    ctx.beginPath();
    const torsoH = (C.torsoH || C.size) * s;
    ctx.ellipse(0, torsoH + 4 - bounce, (20 + (bounce/s)) * s, 4*s, 0, 0, Math.PI * 2);
    ctx.fill();

    if (C.shape === 'circle' || C.shape === 'rect') {
        // â”€â”€ ã‚¯ãƒ©ã‚·ãƒƒã‚¯æç”» (ãƒªãƒƒãƒç‰ˆ) â”€â”€
        ctx.save();
        ctx.translate(0, bounce);
        const baseCol = C.cBody || C.color;
        
        const grad = ctx.createLinearGradient(0, -C.size*2*s, 0, 0);
        grad.addColorStop(0, adjustColor(baseCol, 20));
        grad.addColorStop(1, adjustColor(baseCol, -20));
        ctx.fillStyle = grad;

        if (C.shape === 'circle') {
            ctx.beginPath(); ctx.arc(0, -C.size*s + breath, C.size*s, 0, Math.PI*2); ctx.fill();
            ctx.strokeStyle = 'rgba(0,0,0,0.2)'; ctx.lineWidth = 1.5*s; ctx.stroke();
        } else {
            const rx = -C.size*s, ry = -C.size*2*s + breath, rw = C.size*2*s, rh = C.size*2*s;
            ctx.fillRect(rx, ry, rw, rh);
            ctx.strokeStyle = 'rgba(0,0,0,0.2)'; ctx.lineWidth = 1.5*s; ctx.strokeRect(rx, ry, rw, rh);
            // ãƒ„ãƒ
            ctx.fillStyle = adjustColor(baseCol, -40);
            ctx.beginPath(); ctx.moveTo(rx, ry); ctx.lineTo(rx - 5*s, ry - 5*s); ctx.lineTo(rx + 8*s, ry); ctx.fill();
            ctx.beginPath(); ctx.moveTo(rx + rw, ry); ctx.lineTo(rx + rw + 5*s, ry - 5*s); ctx.lineTo(rx + rw - 8*s, ry); ctx.fill();
        }
        // ç›®
        ctx.fillStyle = '#fff';
        ctx.fillRect(-C.size*0.5*s, -C.size*1.5*s + breath, 4*s, 4*s);
        ctx.fillRect(C.size*0.2*s, -C.size*1.5*s + breath, 4*s, 4*s);
        ctx.restore();
    } else {
        // â”€â”€ äººå‹æç”» (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç‰ˆ) â”€â”€
        let ap = 0, at = null;
        let walkShiftX = 0;
        
        if (isAttacking) {
            at = ad.type;
            const rawP = 1 - (ad.cooldown / ad.maxCD);
            // æ”»æ’ƒã«ç·©æ€¥ (Easing) ã‚’åŠ ãˆã‚‹
            // æºœã‚(0-0.4) -> æŒ¯ã‚Š(0.4-0.6) -> ãƒ•ã‚©ãƒ­ãƒ¼ã‚¹ãƒ«ãƒ¼(0.6-1.0)
            if (rawP < 0.4) {
                ap = rawP * 0.5; // ã˜ã£ãã‚Šæºœã‚ã‚‹
            } else if (rawP < 0.6) {
                ap = 0.2 + (rawP - 0.4) * 3.5; // ä¸€æ°—ã«æŒ¯ã‚ŠæŠœã
            } else {
                ap = 0.9 + (rawP - 0.6) * 0.25; // ä½™éŸ»
            }
            
            // è¸ã¿è¾¼ã¿ã®ç§»å‹•
            walkShiftX = Math.sin(rawP * Math.PI) * 15 * s;
        }

        const facing = (x < 400) ? 1 : -1;
        if (facing === -1) ctx.scale(-1, 1);
        ctx.translate(walkShiftX, 0);

        // èƒ´ä½“
        ctx.save();
        ctx.translate(0, bounce);
        const bodyGrad = ctx.createLinearGradient(-C.torsoW/2*s, 0, C.torsoW/2*s, 0);
        bodyGrad.addColorStop(0, adjustColor(C.cBody, -15)); bodyGrad.addColorStop(0.5, C.cBody); bodyGrad.addColorStop(1, adjustColor(C.cBody, -25));
        ctx.fillStyle = bodyGrad;
        const tx = -C.torsoW/2 * s, ty = -C.torsoH/2 * s + breath, tw = C.torsoW * s, th = C.torsoH * s;
        ctx.fillRect(tx, ty, tw, th);
        ctx.strokeStyle = 'rgba(255,255,255,0.1)'; ctx.lineWidth = 1*s; ctx.strokeRect(tx+1*s, ty+1*s, tw-2*s, th-2*s);

        // é ­éƒ¨
        ctx.save();
        ctx.translate(0, ty); ctx.rotate(walkCycle * 0.1);
        const headGrad = ctx.createLinearGradient(0, -C.headH*s, 0, 0);
        headGrad.addColorStop(0, adjustColor(C.cHead, 10)); headGrad.addColorStop(1, C.cHead);
        ctx.fillStyle = headGrad;
        const hx = -C.headW/2 * s, hy = -C.headH * s, hw = C.headW * s, hh = C.headH * s;
        ctx.fillRect(hx, hy, hw, hh);
        // ãƒã‚¤ã‚¶ãƒ¼
        ctx.fillStyle = C.cEye || '#38bdf8';
        const ex = C.headW/2 * s - 7*s, ey = hy + 6*s, ew = 6*s, eh = 2*s;
        ctx.fillRect(ex, ey, ew, eh);
        ctx.fillStyle = 'rgba(255,255,255,0.7)'; ctx.fillRect(ex+1*s, ey+0.5*s, 1.5*s, 0.5*s);
        ctx.restore();

        const weapon = (target === 'player' || target === 'boss') ? { type: 'sword' } : null;
        const wpnCfg = { armLen: 22, armW: 4, tipSize: 8, tipShape: 0, cArm: C.cArms, cTip: '#e2e8f0' };

        // å¥¥ã®æ‰‹è¶³
        ctx.globalAlpha = 0.6;
        drawLimb(ctx, -C.shoulderX*s, C.shoulderY*s + breath + bounce, -walkCycle, true, true, at, ap, C, s, weapon, wpnCfg, m.attack);
        drawLimb(ctx, -C.hipX*s, C.hipY*s + breath + bounce, walkCycle, false, true, null, 0, C, s);
        ctx.globalAlpha = 1.0;
        // æ‰‹å‰ã®æ‰‹è¶³
        drawLimb(ctx, C.shoulderX*s, C.shoulderY*s + breath + bounce, walkCycle, true, false, at, ap, C, s, weapon, wpnCfg, m.attack);
        drawLimb(ctx, C.hipX*s, C.hipY*s + breath + bounce, -walkCycle, false, false, null, 0, C, s);

        // ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ (è–åå­—)
        if (isAttacking && at === 'grandcross') {
            const glow = m.attack.grandGlow * s;
            const size = glow * (1 + Math.sin(time * 0.05) * 0.2) * ap * 3.5;
            ctx.save();
            ctx.translate(70*s*ap, -35*s);
            ctx.rotate(time * 0.03);
            ctx.shadowBlur = 15; ctx.shadowColor = '#fbbf24';
            ctx.fillStyle = 'rgba(251,191,36,0.4)'; ctx.fillRect(-size/2, -8*s, size, 16*s); ctx.fillRect(-8*s, -size/2, 16*s, size);
            ctx.shadowBlur = 8; ctx.shadowColor = '#fff';
            ctx.fillStyle = 'rgba(255,255,255,0.9)'; ctx.fillRect(-size/2, -2.5*s, size, 5*s); ctx.fillRect(-2.5*s, -size/2, 5*s, size);
            ctx.restore();
        }
        ctx.restore(); // bounce translate ã‚’é–‰ã˜ã‚‹
    }
    ctx.restore(); // drawEntity ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã‚’é–‰ã˜ã‚‹
}

function drawLimb(ctx, x, y, angle, isArm, isBack, attackType, attackPhase, C, s, weapon, wpnCfg, attCfg) {
    ctx.save();
    ctx.translate(x, y);

    let finalAngle = angle;
    let elbow = (isArm ? C.elbowAngle : C.kneeAngle);
    
    // æ”»æ’ƒãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã®è§’åº¦
    if (isArm && attackType) {
        if (attackType === 'weak' || attackType === 'normal') {
            const arc = attCfg?.weakArc || 2.0;
            finalAngle = -1.5 + Math.sin(attackPhase * Math.PI) * arc;
            elbow = 0.2;
        } else if (attackType === 'front-wide') {
            finalAngle = -1.5 + attackPhase * 4;
            elbow = 0.1;
        } else if (attackType === 'pierce') {
            finalAngle = -1.5; elbow = 0;
            ctx.translate(Math.sin(attackPhase * Math.PI) * 20 * s, 0);
        } else if (attackType === 'grandcross') {
            finalAngle = -Math.PI/2 + Math.sin(attackPhase * Math.PI * 2) * 0.5;
            elbow = 0.1;
        }
    }

    ctx.rotate(finalAngle);

    const uW = (isArm ? C.upperArmW : C.upperLegW) * s;
    const uL = (isArm ? C.upperArmLen : C.upperLegLen) * s;
    const lW = (isArm ? C.lowerArmW : C.lowerLegW) * s;
    const lL = (isArm ? C.lowerArmLen : C.lowerLegLen) * s;

    const baseCol = isArm ? C.cArms : C.cLegs;
    
    // ä¸Šéƒ¨ãƒ‘ãƒ¼ãƒ„ (ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³)
    const uGrad = ctx.createLinearGradient(-uW/2, 0, uW/2, 0);
    uGrad.addColorStop(0, adjustColor(baseCol, -10));
    uGrad.addColorStop(1, adjustColor(baseCol, 10));
    ctx.fillStyle = uGrad;
    ctx.fillRect(-uW/2, 0, uW, uL);

    // ä¸‹éƒ¨ãƒ‘ãƒ¼ãƒ„
    ctx.translate(0, uL);
    ctx.rotate(elbow);
    const lGrad = ctx.createLinearGradient(-lW/2, 0, lW/2, 0);
    lGrad.addColorStop(0, adjustColor(baseCol, -15));
    lGrad.addColorStop(1, adjustColor(baseCol, 5));
    ctx.fillStyle = lGrad;
    ctx.fillRect(-lW/2, 0, lW, lL);

    // æ­¦å™¨
    if (isArm && !isBack && weapon) {
        ctx.save();
        ctx.translate(0, lL - 2*s);
        ctx.rotate(-elbow - 0.2);
        
        // æŸ„
        ctx.fillStyle = '#475569';
        ctx.fillRect(-2*s, 0, 4*s, 6*s);
        
        // åˆƒ (ãƒ¡ã‚¿ãƒ«ãƒã‚¤ãƒ©ã‚¤ãƒˆ)
        const bladeGrad = ctx.createLinearGradient(-s*4, 0, s*4, 0);
        bladeGrad.addColorStop(0, '#94a3b8');
        bladeGrad.addColorStop(0.5, '#f8fafc'); // ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        bladeGrad.addColorStop(1, '#64748b');
        ctx.fillStyle = bladeGrad;
        
        ctx.beginPath();
        ctx.moveTo(-s*4, 6*s);
        ctx.lineTo(s*4, 6*s);
        ctx.lineTo(s*2, (wpnCfg.armLen + 10)*s);
        ctx.lineTo(0, (wpnCfg.armLen + 15)*s); // å°–ç«¯
        ctx.lineTo(-s*2, (wpnCfg.armLen + 10)*s);
        ctx.fill();
        ctx.restore();
    }

    ctx.restore();
}

// â”€â”€ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ â”€â”€
// â”€â”€ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ â”€â”€
function triggerAttack(type) {
    if (STATE.player.attackCooldown > 0) return;
    STATE.player.attackType = type;
    
    // ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³é€Ÿåº¦åæ˜ 
    const m = (CONFIGS[editTarget].motions || DEFAULTS.player.motions);
    const speed = m.attack.speed || 1.0;
    
    let cd = (type === 'normal' || type === 'weak' ? 400 : 800);
    if (type === 'grandcross') cd = 1200;
    
    // é€Ÿåº¦ã§CDèª¿æ•´
    cd = cd / speed;

    STATE.player.attackCooldown = cd;
    STATE.player.lastMaxCooldown = cd;
    currentMotion = type;

    setTimeout(() => {
        const dist = Math.abs(STATE.player.x - STATE.enemy.x);
        if (dist < 150) {
            STATE.enemy.knockback = 20;
            spawnParticles(STATE.enemy.x, STATE.enemy.y);
        }
    }, cd * 0.4);
}

function spawnParticles(x, y) {
    for (let i = 0; i < 8; i++) {
        STATE.particles.push({
            x, y, vx: (Math.random()-0.5)*12, vy: (Math.random()-0.5)*12,
            life: 1.0, color: '#ffea00'
        });
    }
}

// â”€â”€ UIé€£æº â”€â”€
function setup() {
    function $(id) { return document.getElementById(id); }

    const bind = (id, key, vid) => {
        const el = $(id);
        if (!el) return; // å®‰å…¨ç­–: è¦ç´ ãŒãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
        el.oninput = () => {
            CONFIGS[editTarget][key] = parseFloat(el.value);
            if (vid && $(vid)) $(vid).innerText = el.value;
            saveToLocal(editTarget);
        };
    };

    const playerSliders = [
        ['p-scale','scale','v-scale'], ['p-headW','headW','v-headW'], ['p-torsoH','torsoH','v-torsoH'],
        ['p-upperArmLen','upperArmLen','v-upperArmLen'], ['p-upperLegLen','upperLegLen','v-upperLegLen'],
        ['p-shoulderX','shoulderX','v-shoulderX'], ['p-shoulderY','shoulderY','v-shoulderY'],
        ['p-hipX','hipX','v-hipX'], ['p-hipY','hipY','v-hipY']
    ];
    playerSliders.forEach(s => bind(s[0], s[1], s[2]));
    bind('p-size', 'size', 'v-size');
    bind('p-shadowAlpha', 'shadowAlpha', 'v-shadowAlpha');

    $('pc-body').oninput = (e) => { 
        CONFIGS[editTarget].cBody = e.target.value; 
        if (CONFIGS[editTarget].color !== undefined) CONFIGS[editTarget].color = e.target.value;
        saveToLocal(editTarget);
    };
    $('pc-head').oninput = (e) => { 
        CONFIGS[editTarget].cHead = e.target.value; 
        saveToLocal(editTarget);
    };

    // â”€â”€ ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ç³»åŒæœŸ â”€â”€
    function syncMotionUI() {
        const C = CONFIGS[editTarget];
        const M = C.motions;
        if (!M) return;

        // å…¨ã‚µãƒ–ãƒ‘ãƒãƒ«ã‚’éš ã™
        document.querySelectorAll('.motion-subpanel').forEach(p => p.classList.add('hidden'));

        if (currentMotion === 'idle') {
            $('motion-idle').classList.remove('hidden');
            $('m-idle-breathSpeed').value = M.idle.breathSpeed;
            $('vm-idle-breathSpeed').innerText = M.idle.breathSpeed;
            $('m-idle-breathAmount').value = M.idle.breathAmount;
            $('vm-idle-breathAmount').innerText = M.idle.breathAmount;
        } else if (currentMotion === 'walk') {
            $('motion-walk').classList.remove('hidden');
            $('m-walk-walkSpeed').value = M.walk.walkSpeed;
            $('vm-walk-walkSpeed').innerText = M.walk.walkSpeed;
            $('m-walk-walkAmplitude').value = M.walk.walkAmplitude;
            $('vm-walk-walkAmplitude').innerText = M.walk.walkAmplitude;
        } else if (currentMotion !== 'base') {
            $('motion-attack').classList.remove('hidden');
            $('m-attack-speed').value = M.attack.speed;
            $('vm-attack-speed').innerText = M.attack.speed;
            
            $('attack-extra-weak').classList.toggle('hidden', currentMotion !== 'weak');
            $('attack-extra-grand').classList.toggle('hidden', currentMotion !== 'grandcross');
            
            if (currentMotion === 'weak') {
                $('m-weak-arc').value = M.attack.weakArc;
                $('vm-weak-arc').innerText = M.attack.weakArc;
            } else if (currentMotion === 'grandcross') {
                $('m-grand-glow').value = M.attack.grandGlow;
                $('vm-grand-glow').innerText = M.attack.grandGlow;
            }
        }
    }

    const mBind = (id, targetObj, key, vid) => {
        $(id).oninput = (e) => {
            targetObj[key] = parseFloat(e.target.value);
            if (vid) $(vid).innerText = e.target.value;
            saveToLocal(editTarget);
        };
    };

    // ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ãƒã‚¤ãƒ³ãƒ‰
    const setupMotionBinds = () => {
        const C = CONFIGS[editTarget];
        if (!C.motions) return;
        mBind('m-idle-breathSpeed', C.motions.idle, 'breathSpeed', 'vm-idle-breathSpeed');
        mBind('m-idle-breathAmount', C.motions.idle, 'breathAmount', 'vm-idle-breathAmount');
        mBind('m-walk-walkSpeed', C.motions.walk, 'walkSpeed', 'vm-walk-walkSpeed');
        mBind('m-walk-walkAmplitude', C.motions.walk, 'walkAmplitude', 'vm-walk-walkAmplitude');
        mBind('m-attack-speed', C.motions.attack, 'speed', 'vm-attack-speed');
        mBind('m-weak-arc', C.motions.attack, 'weakArc', 'vm-weak-arc');
        mBind('m-grand-glow', C.motions.attack, 'grandGlow', 'vm-grand-glow');
    };

    function syncUI() {
        const C = CONFIGS[editTarget];
        const isHuman = (editTarget === 'player' || editTarget === 'boss');
        const isBase = (currentMotion === 'base');

        // ã‚¿ãƒ–ã¨ãƒ‘ãƒãƒ«ã®è¡¨ç¤ºåˆ¶å¾¡
        $('panel-skeleton').classList.toggle('hidden', !isBase);
        $('panel-joints').classList.toggle('hidden', !isBase || !isHuman);
        $('panel-motion').classList.toggle('hidden', isBase);
        
        // ã‚¿ãƒ–ãƒœã‚¿ãƒ³è‡ªä½“ã®è¡¨ç¤ºåˆ¶å¾¡
        document.querySelectorAll('.tab-btn-d').forEach(btn => {
            const p = btn.dataset.panel;
            if (p === 'skeleton' || p === 'joints') btn.classList.toggle('hidden', !isBase);
            if (p === 'export') btn.classList.remove('hidden');
        });

        if (!isBase) syncMotionUI();
        setupMotionBinds();

        $('skel-humanoid').classList.toggle('hidden', !isHuman);
        $('skel-classic').classList.toggle('hidden', isHuman);
        $('joints-humanoid').classList.toggle('hidden', !isHuman);
        $('joints-classic').classList.toggle('hidden', isHuman);
        
        $('current-target-label').innerText = `EDITING: ${editTarget.toUpperCase()}${isBase ? ' (ç´ ä½“)' : ' ('+currentMotion+')'}`;
        
        // å€¤ã®åæ˜ 
        for (let key in C) {
            if (key === 'motions') continue;
            const el = $('p-' + key);
            if (el) {
                el.value = C[key];
                const valEl = $('v-' + key);
                if (valEl) valEl.innerText = C[key];
            }
        }
        $('pc-body').value = C.cBody || C.color || '#ffffff';
        $('pc-head').value = C.cHead || '#ffffff';
    }

    document.querySelectorAll('.target-btn').forEach(btn => btn.onclick = () => {
        document.querySelectorAll('.target-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        editTarget = btn.dataset.target;
        syncUI();
    });

    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ“ä½œ
    let startX, startY;
    canvas.onmousedown = (e) => { startX = e.offsetX; startY = e.offsetY; };
    canvas.onmouseup = (e) => {
        const dx = e.offsetX - startX, dy = e.offsetY - startY;
        if (Math.abs(dx) > 30 || Math.abs(dy) > 30) {
            if (dx > 30) triggerAttack('pierce');
            else triggerAttack('front-wide');
        } else triggerAttack('normal');
    };
    canvas.oncontextmenu = (e) => e.preventDefault();

    // ã‚¿ãƒ–
    document.querySelectorAll('.tab-btn-d').forEach(btn => btn.onclick = () => {
        document.querySelectorAll('.tab-btn-d').forEach(b => b.classList.remove('active')); btn.classList.add('active');
        document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden')); $('panel-'+btn.dataset.panel).classList.remove('hidden');
    });

    document.querySelectorAll('.motion-btn').forEach(btn => btn.onclick = () => {
        document.querySelectorAll('.motion-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active');
        currentMotion = btn.dataset.motion;
        if (currentMotion !== 'idle' && currentMotion !== 'walk' && currentMotion !== 'base') {
            triggerAttack(currentMotion);
        } else {
            STATE.player.attackCooldown = 0;
            syncUI();
        }
    });

    $('btn-copy-config').onclick = () => {
        const json = `// ğŸ¤– ADMIN REFRESH [${editTarget}]\nconst ${editTarget.toUpperCase()}_CONFIG = ${JSON.stringify(CONFIGS[editTarget], null, 2)};`;
        $('config-json').value = json;
        navigator.clipboard.writeText(json);
        const s = $('copy-status'); s.style.opacity = 1; setTimeout(()=>s.style.opacity=0, 1500);
    };

    $('btn-reset').onclick = () => {
        if (confirm(`${editTarget.toUpperCase()} ã®ç·¨é›†å†…å®¹ã‚’ã‚³ãƒ¼ãƒ‰ã®åˆæœŸå€¤ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ`)) {
            localStorage.removeItem(TARGET_KEYS[editTarget]);
            CONFIGS[editTarget] = { ...DEFAULTS[editTarget] };
            syncUI();
            alert('ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚æœ¬ä½“å´ã‚‚ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨å…ƒã«æˆ»ã‚Šã¾ã™ã€‚');
        }
    };

    let lastFrame = performance.now();
    function loop(now) {
        const dt = now - lastFrame; lastFrame = now;
        ctx.clearRect(0,0,800,600);
        
        if (showGrid) {
            ctx.strokeStyle = 'rgba(51,65,85,0.1)';
            for(let i=0; i<800; i+=20) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,600); ctx.stroke(); }
            for(let i=0; i<600; i+=20) { ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(800,i); ctx.stroke(); }
        }

        if (STATE.player.attackCooldown > 0) {
            STATE.player.attackCooldown -= dt;
            if (STATE.player.attackCooldown <= 0) currentMotion = 'idle';
        }
        if (STATE.enemy.knockback > 0) {
            STATE.enemy.x += STATE.enemy.knockback;
            STATE.enemy.knockback *= 0.9;
        } else {
            STATE.enemy.x += (500 - STATE.enemy.x) * 0.1;
        }

        // æç”»
        const pAtt = STATE.player.attackCooldown > 0 ? { cooldown: STATE.player.attackCooldown, maxCD: STATE.player.lastMaxCooldown, type: STATE.player.attackType } : null;
        
        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡ã«ã‚ˆã£ã¦æç”»é †ã‚„è¡¨ç¤ºã‚’å¤‰ãˆã‚‹
        if (editTarget === 'player') {
            drawEntity(ctx, STATE.enemy.x, STATE.enemy.y, 'enemy1', 'walk', now, null);
            drawEntity(ctx, STATE.player.x, STATE.player.y, 'player', currentMotion, now, pAtt);
        } else if (editTarget === 'boss') {
            drawEntity(ctx, STATE.player.x, STATE.player.y, 'player', 'walk', now, null);
            drawEntity(ctx, STATE.enemy.x, STATE.enemy.y, 'boss', currentMotion, now, pAtt);
        } else {
            drawEntity(ctx, STATE.player.x, STATE.player.y, 'player', 'walk', now, null);
            drawEntity(ctx, STATE.enemy.x, STATE.enemy.y, editTarget, 'walk', now, null);
        }

        STATE.particles = STATE.particles.filter(p => {
            p.x += p.vx; p.y += p.vy; p.life -= 0.02;
            ctx.fillStyle = p.color; ctx.globalAlpha = p.life;
            ctx.fillRect(p.x, p.y, 4, 4);
            ctx.globalAlpha = 1; return p.life > 0;
        });

        requestAnimationFrame(loop);
    }
    
    $('btn-zoom-in').onclick = () => zoom = Math.min(4, zoom+0.2);
    $('btn-zoom-out').onclick = () => zoom = Math.max(0.5, zoom-0.2);
    $('btn-toggle-grid').onclick = () => showGrid = !showGrid;

    syncUI();
    requestAnimationFrame(loop);
}

setup();
</script>