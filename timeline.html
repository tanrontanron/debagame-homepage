<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>タイムライン - プロダクトサイト</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', 'Noto Sans JP', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); }
        .spinner { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .main-content { margin-left: 0; transition: margin-left 0.3s ease; }
        @media (min-width: 1024px) {
            .main-content { margin-left: 0; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <!-- Sidebar Component -->
    <nav id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-gray-900 text-white transform -translate-x-full transition-transform duration-300 ease-in-out z-50">
        <div class="flex items-center justify-between p-4 border-b border-gray-700">
            <h2 class="text-lg font-semibold">メニュー</h2>
            <button id="sidebar-close" class="text-gray-400 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div class="p-4">
            <ul class="space-y-2">
                <li><a href="./index.html" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors"><i class="fas fa-home mr-3"></i>トップページ</a></li>
                <li><a href="./Interactive_worldmap/worldmap.html" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors"><i class="fas fa-globe mr-3"></i>世界地図</a></li>
                <li><a href="./timeline.html" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors"><i class="fas fa-timeline mr-3"></i>タイムライン</a></li>
                <li><a href="./bear/index.html" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors"><i class="fas fa-chart-line mr-3"></i>熊被害状況</a></li>
                <li><a href="./numberplate/numberplate.html" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-colors"><i class="fas fa-car-side mr-3"></i>ナンバープレート</a></li>
            </ul>
        </div>
        <div class="absolute bottom-4 left-4 right-4"><div class="text-xs text-gray-400 text-center"><p>&copy; 2024 プロダクトサイト</p></div></div>
    </nav>
    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
    <button id="sidebar-toggle" class="fixed top-4 left-4 z-30 bg-gray-900 text-white p-3 rounded-lg shadow-lg hover:bg-gray-800 transition-colors"><i class="fas fa-bars"></i></button>

    <!-- Main Content -->
    <div class="main-content">
    <!-- Header -->
    <header class="gradient-bg text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <div class="w-20 h-20 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-timeline text-3xl"></i>
            </div>
            <h1 class="text-4xl font-bold mb-2">タイムライン</h1>
            <p class="text-xl text-green-100">イベントを時系列で管理・表示するFlaskアプリケーション</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-12">
        <div class="max-w-4xl mx-auto">
            <!-- App Status Check -->
            <div id="status-check" class="bg-white rounded-xl p-8 shadow-lg mb-8">
                <div class="text-center">
                    <div class="spinner w-8 h-8 border-4 border-green-200 border-t-green-600 rounded-full mx-auto mb-4"></div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">アプリケーションの状態を確認中...</h2>
                    <p class="text-gray-600">Flaskアプリケーションが起動しているかチェックしています</p>
                </div>
            </div>

            <!-- App Running -->
            <div id="app-running" class="bg-white rounded-xl p-8 shadow-lg mb-8 hidden">
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-check text-2xl text-green-600"></i>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">アプリケーションが起動しています！</h2>
                    <p class="text-gray-600 mb-6">タイムラインアプリケーションにアクセスできます</p>
                    <div class="space-y-3">
                        <a href="http://localhost:5000" 
                           class="inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            <i class="fas fa-external-link-alt mr-2"></i>
                            タイムラインアプリを開く
                        </a>
                        <div class="text-sm text-gray-500">
                            または <a href="http://127.0.0.1:5000" class="text-blue-600 hover:underline">http://127.0.0.1:5000</a> に直接アクセス
                        </div>
                    </div>
                </div>
            </div>

            <!-- App Not Running -->
            <div id="app-not-running" class="bg-white rounded-xl p-8 shadow-lg mb-8 hidden">
                <div class="text-center">
                    <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-exclamation-triangle text-2xl text-yellow-600"></i>
                    </div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">アプリケーションが起動していません</h2>
                    <p class="text-gray-600 mb-6">以下の手順でFlaskアプリケーションを起動してください</p>
                    <div class="mt-4">
                        <a href="http://127.0.0.1:5000" 
                           class="inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors mr-3">
                            <i class="fas fa-external-link-alt mr-2"></i>
                            直接アクセスを試す
                        </a>
                        <button onclick="manualCheck()" 
                                class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            <i class="fas fa-sync-alt mr-2"></i>
                            再チェック
                        </button>
                    </div>
                </div>
            </div>

            <!-- Instructions -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Start Instructions -->
                <div class="bg-white rounded-xl p-6 shadow-lg card-hover">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-play text-green-500 mr-2"></i>
                        アプリケーションの起動方法
                    </h3>
                    <div class="space-y-4 text-sm text-gray-600">
                        <div class="flex items-start">
                            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded mr-3 mt-1">1</span>
                            <p>ターミナル（コマンドプロンプト）を開く</p>
                        </div>
                        <div class="flex items-start">
                            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded mr-3 mt-1">2</span>
                            <p>以下のコマンドを実行：</p>
                        </div>
                        <div class="bg-gray-100 p-3 rounded font-mono text-xs">
                            cd site/Python/timeline<br>
                            python app.py
                        </div>
                        <div class="flex items-start">
                            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded mr-3 mt-1">3</span>
                            <p>「Running on http://127.0.0.1:5000」と表示されたら起動完了</p>
                        </div>
                    </div>
                </div>

                <!-- Features -->
                <div class="bg-white rounded-xl p-6 shadow-lg card-hover">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-star text-blue-500 mr-2"></i>
                        主な機能
                    </h3>
                    <ul class="space-y-3 text-sm text-gray-600">
                        <li class="flex items-center">
                            <i class="fas fa-check text-green-500 mr-2"></i>
                            時系列でのイベント表示
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-check text-green-500 mr-2"></i>
                            点イベントと期間イベントの管理
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-check text-green-500 mr-2"></i>
                            カテゴリ別の整理
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-check text-green-500 mr-2"></i>
                            元号表示対応
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-check text-green-500 mr-2"></i>
                            ドラッグ&ドロップでの並び替え
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-check text-green-500 mr-2"></i>
                            リアルタイム編集
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Back to Top -->
            <div class="text-center mt-8 space-x-4">
                <a href="python-install-guide.html" class="inline-flex items-center px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors">
                    <i class="fab fa-python mr-2"></i>
                    Pythonインストールガイド
                </a>
                <a href="deployment-guide.html" class="inline-flex items-center px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                    <i class="fas fa-rocket mr-2"></i>
                    デプロイメントガイド
                </a>
                <a href="index.html" class="inline-flex items-center px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                    <i class="fas fa-arrow-left mr-2"></i>
                    トップページに戻る
                </a>
            </div>
        </div>
    </main>
    </div> <!-- End main-content -->

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- Sidebar Logic ---
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebarClose = document.getElementById('sidebar-close');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        
        function openSidebar() {
            if (!sidebar || !sidebarOverlay) return;
            sidebar.classList.remove('-translate-x-full');
            sidebarOverlay.classList.remove('hidden');
            document.body.classList.add('overflow-hidden');
        }
        
        function closeSidebar() {
            if (!sidebar || !sidebarOverlay) return;
            sidebar.classList.add('-translate-x-full');
            sidebarOverlay.classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
        }

        if (sidebarToggle) sidebarToggle.addEventListener('click', openSidebar);
        if (sidebarClose) sidebarClose.addEventListener('click', closeSidebar);
        if (sidebarOverlay) sidebarOverlay.addEventListener('click', closeSidebar);
        
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeSidebar(); });

        // --- Active Page Highlight Logic ---
        try {
            const currentPath = window.location.pathname;
            document.querySelectorAll('#sidebar a').forEach(link => {
                const linkHref = link.getAttribute('href');
                const linkUrl = new URL(linkHref, window.location.href);
                if (linkUrl.pathname === currentPath) {
                    link.classList.add('bg-blue-600', 'text-white');
                    link.classList.remove('hover:bg-gray-700');
                }
            });
        } catch (e) {
            console.error("Error highlighting current page:", e);
        }
    });
    </script>

    <script>
        // アプリケーションの状態をチェック
        function checkAppStatus() {
            // 複数の方法でアプリの状態をチェック
            const checkMethods = [
                // 方法1: fetch with no-cors
                fetch('http://localhost:5000', { mode: 'no-cors' })
                    .then(() => true)
                    .catch(() => false),
                
                // 方法2: Image オブジェクトを使用
                new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => resolve(true);
                    img.onerror = () => resolve(false);
                    img.src = 'http://localhost:5000/favicon.ico';
                    setTimeout(() => resolve(false), 2000); // 2秒でタイムアウト
                }),
                
                // 方法3: XMLHttpRequest
                new Promise((resolve) => {
                    const xhr = new XMLHttpRequest();
                    xhr.timeout = 2000;
                    xhr.onload = () => resolve(xhr.status >= 200 && xhr.status < 400);
                    xhr.onerror = () => resolve(false);
                    xhr.ontimeout = () => resolve(false);
                    try {
                        xhr.open('GET', 'http://localhost:5000', true);
                        xhr.send();
                    } catch (e) {
                        resolve(false);
                    }
                })
            ];

            // いずれかの方法で成功したらアプリが起動していると判定
            Promise.race(checkMethods)
                .then(isRunning => {
                    document.getElementById('status-check').classList.add('hidden');
                    if (isRunning) {
                        document.getElementById('app-running').classList.remove('hidden');
                    } else {
                        document.getElementById('app-not-running').classList.remove('hidden');
                    }
                })
                .catch(() => {
                    document.getElementById('status-check').classList.add('hidden');
                    document.getElementById('app-not-running').classList.remove('hidden');
                });
        }

        // ページ読み込み時にチェック
        checkAppStatus();

        // 10秒ごとに再チェック（より頻繁にチェック）
        setInterval(checkAppStatus, 10000);
        
        // 手動チェックボタンを追加
        function manualCheck() {
            document.getElementById('status-check').classList.remove('hidden');
            document.getElementById('app-running').classList.add('hidden');
            document.getElementById('app-not-running').classList.add('hidden');
            checkAppStatus();
        }
        
        // 手動チェックボタンのイベントリスナーを追加
        document.addEventListener('DOMContentLoaded', function() {
            // 手動チェックボタンを動的に追加
            const notRunningDiv = document.getElementById('app-not-running');
            if (notRunningDiv) {
                const checkButton = document.createElement('button');
                checkButton.textContent = '再チェック';
                checkButton.className = 'mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors';
                checkButton.onclick = manualCheck;
                notRunningDiv.querySelector('.text-center').appendChild(checkButton);
            }
        });
    </script>
</body>
</html>
