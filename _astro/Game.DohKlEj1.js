import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r,b as T}from"./index.C3W4X1sy.js";var s=(c=>(c.NATURAL="NATURAL",c.SHARP="SHARP",c))(s||{});const v=[{id:"C4",note:"C4",frequency:261.63,type:s.NATURAL,color:"",keyBind:"a",label:"ã©"},{id:"C#4",note:"C#4",frequency:277.18,type:s.SHARP,color:"",keyBind:"w",label:"ã‚Œâ™­"},{id:"D4",note:"D4",frequency:293.66,type:s.NATURAL,color:"",keyBind:"s",label:"ã‚Œ"},{id:"D#4",note:"D#4",frequency:311.13,type:s.SHARP,color:"",keyBind:"e",label:"ã¿â™­"},{id:"E4",note:"E4",frequency:329.63,type:s.NATURAL,color:"",keyBind:"d",label:"ã¿"},{id:"F4",note:"F4",frequency:349.23,type:s.NATURAL,color:"",keyBind:"f",label:"ãµã"},{id:"F#4",note:"F#4",frequency:369.99,type:s.SHARP,color:"",keyBind:"t",label:"ãâ™­"},{id:"G4",note:"G4",frequency:392,type:s.NATURAL,color:"",keyBind:"g",label:"ã"},{id:"G#4",note:"G#4",frequency:415.3,type:s.SHARP,color:"",keyBind:"y",label:"ã‚‰â™­"},{id:"A4",note:"A4",frequency:440,type:s.NATURAL,color:"",keyBind:"h",label:"ã‚‰"},{id:"A#4",note:"A#4",frequency:466.16,type:s.SHARP,color:"",keyBind:"u",label:"ã—â™­"},{id:"B4",note:"B4",frequency:493.88,type:s.NATURAL,color:"",keyBind:"j",label:"ã—"},{id:"C5",note:"C5",frequency:523.25,type:s.NATURAL,color:"",keyBind:"k",label:"ã©"},{id:"C#5",note:"C#5",frequency:554.37,type:s.SHARP,color:"",keyBind:"o",label:"ã‚Œâ™­"},{id:"D5",note:"D5",frequency:587.33,type:s.NATURAL,color:"",keyBind:"l",label:"ã‚Œ"},{id:"D#5",note:"D#5",frequency:622.25,type:s.SHARP,color:"",keyBind:"p",label:"ã¿â™­"},{id:"E5",note:"E5",frequency:659.25,type:s.NATURAL,color:"",keyBind:";",label:"ã¿"},{id:"F5",note:"F5",frequency:698.46,type:s.NATURAL,color:"",keyBind:"z",label:"ãµã"},{id:"F#5",note:"F#5",frequency:739.99,type:s.SHARP,color:"",keyBind:"n",label:"ãâ™­"},{id:"G5",note:"G5",frequency:783.99,type:s.NATURAL,color:"",keyBind:"x",label:"ã"},{id:"G#5",note:"G#5",frequency:830.61,type:s.SHARP,color:"",keyBind:"m",label:"ã‚‰â™­"},{id:"A5",note:"A5",frequency:880,type:s.NATURAL,color:"",keyBind:"c",label:"ã‚‰"},{id:"A#5",note:"A#5",frequency:932.33,type:s.SHARP,color:"",keyBind:",",label:"ã—â™­"},{id:"B5",note:"B5",frequency:987.77,type:s.NATURAL,color:"",keyBind:"v",label:"ã—"},{id:"C6",note:"C6",frequency:1046.5,type:s.NATURAL,color:"",keyBind:"b",label:"ã©"}],R=({note:c,isActive:a,onPlay:l,index:t,totalNotes:o,showNoteLabels:m,showKeyLabels:h})=>{const A=(N,d)=>{const u=N/d,n=10+u*10,x=65+u*10,f=35+u*10;return`hsl(${n}, ${x}%, ${f}%)`},i=c.type===s.SHARP,w=i?"w-8 sm:w-9 md:w-11":"w-10 sm:w-12 md:w-14",p=i?{height:`${16-t*.25}rem`}:{height:`${24-t*.3}rem`},y=A(t,o),b={...p,backgroundColor:y,transform:a?"scale(0.98) translateY(2px)":"none",boxShadow:a?"inset 0 2px 4px rgba(0,0,0,0.5)":"0 4px 6px rgba(0,0,0,0.4), inset 0 1px 1px rgba(255,255,255,0.1), inset 0 0 20px rgba(0,0,0,0.2)"};return e.jsxs("div",{className:`
        relative flex flex-col items-center justify-end pb-4 rounded-b-sm rounded-t-sm cursor-pointer transition-all duration-75
        ${w}
        ${i?"z-20 -mx-3 sm:-mx-4":"z-10 mx-0.5"}
        group
      `,style:b,"data-note-id":c.id,onMouseDown:()=>l(c),children:[e.jsx("div",{className:"absolute top-[22%] w-3 h-3 rounded-full bg-black/40 shadow-[inset_0_1px_2px_rgba(0,0,0,0.8)]"}),e.jsx("div",{className:"absolute bottom-[22%] w-3 h-3 rounded-full bg-black/40 shadow-[inset_0_1px_2px_rgba(0,0,0,0.8)]"}),e.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,rgba(0,0,0,0)_0%,rgba(0,0,0,0.1)_20%,rgba(0,0,0,0)_40%,rgba(0,0,0,0.05)_60%,rgba(0,0,0,0)_100%)] pointer-events-none opacity-50 rounded-b-sm rounded-t-sm"}),e.jsxs("div",{className:"z-10 flex flex-col items-center gap-1 text-white/90 drop-shadow-md pointer-events-none mb-2",children:[m&&e.jsx("span",{className:"text-xs sm:text-sm font-bold opacity-90 tracking-wider",children:c.label}),h&&e.jsx("span",{className:"text-[10px] uppercase font-mono bg-black/40 px-1.5 py-0.5 rounded text-white/90 border border-white/10",children:c.keyBind})]}),e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-white/20 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/20 pointer-events-none"})]})};class L{audioContext=null;masterGain=null;volume=.6;getContext(){return this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.audioContext.createGain(),this.masterGain.gain.value=this.volume,this.masterGain.connect(this.audioContext.destination)),this.audioContext.state==="suspended"&&this.audioContext.resume(),this.audioContext}setVolume(a){this.volume=Math.max(0,Math.min(1,a)),this.masterGain&&this.masterGain.gain.setTargetAtTime(this.volume,this.getContext().currentTime,.05)}playNote(a){const l=this.getContext(),t=l.currentTime,o=l.createOscillator();o.type="sine",o.frequency.setValueAtTime(a,t);const m=l.createGain();m.gain.setValueAtTime(0,t),m.gain.linearRampToValueAtTime(1,t+.005),m.gain.exponentialRampToValueAtTime(.01,t+.6),o.connect(m),this.masterGain?m.connect(this.masterGain):m.connect(l.destination),o.start(t),o.stop(t+.6),this.playKnock(t)}playKnock(a){const l=this.getContext(),t=l.createOscillator(),o=l.createGain();t.frequency.setValueAtTime(150,a),t.frequency.exponentialRampToValueAtTime(.01,a+.05),o.gain.setValueAtTime(.3,a),o.gain.exponentialRampToValueAtTime(.001,a+.05),t.connect(o),this.masterGain?o.connect(this.masterGain):o.connect(l.destination),t.start(a),t.stop(a+.05)}playClick(){const a=this.getContext(),l=a.currentTime,t=a.createOscillator(),o=a.createGain();t.frequency.setValueAtTime(1e3,l),o.gain.setValueAtTime(0,l),o.gain.linearRampToValueAtTime(.5,l+.001),o.gain.exponentialRampToValueAtTime(.001,l+.03),t.connect(o),this.masterGain?o.connect(this.masterGain):o.connect(a.destination),t.start(l),t.stop(l+.03)}}const C=new L,S=({showNoteLabels:c,onToggleNoteLabels:a,showKeyLabels:l,onToggleKeyLabels:t})=>{const[o,m]=r.useState(100),[h,A]=r.useState(!1),i=r.useRef(null),[w,p]=r.useState(60);r.useEffect(()=>{C.setVolume(w/100)},[w]),r.useEffect(()=>{if(h){const d=60/o*1e3;i.current=window.setInterval(()=>{C.playClick()},d)}else i.current&&(clearInterval(i.current),i.current=null);return()=>{i.current&&clearInterval(i.current)}},[h,o]);const[y,b]=r.useState(!1),N=d=>e.jsxs("div",{className:`flex ${d?"flex-col gap-6 p-2 w-full":"flex-row items-center gap-4"} text-sm text-stone-700`,children:[e.jsxs("div",{className:`flex flex-shrink-0 ${d?"flex-row justify-between w-full gap-4":"gap-2"}`,children:[e.jsxs("label",{className:`flex items-center gap-2 bg-stone-100/80 rounded-full px-3 py-1.5 border border-stone-300 shadow-sm cursor-pointer hover:bg-stone-200/80 transition-colors ${d?"flex-1 justify-center":""}`,children:[e.jsx("input",{type:"checkbox",checked:c,onChange:u=>a(u.target.checked),className:"w-4 h-4 text-amber-600 rounded focus:ring-amber-500 border-gray-300 accent-amber-600"}),e.jsx("span",{className:"text-xs font-bold text-stone-600 whitespace-nowrap",children:"éŸ³å"})]}),e.jsxs("label",{className:`flex items-center gap-2 bg-stone-100/80 rounded-full px-3 py-1.5 border border-stone-300 shadow-sm cursor-pointer hover:bg-stone-200/80 transition-colors ${d?"flex-1 justify-center":""}`,children:[e.jsx("input",{type:"checkbox",checked:l,onChange:u=>t(u.target.checked),className:"w-4 h-4 text-amber-600 rounded focus:ring-amber-500 border-gray-300 accent-amber-600"}),e.jsx("span",{className:"text-xs font-bold text-stone-600 whitespace-nowrap",children:"ã‚­ãƒ¼"})]})]}),e.jsxs("div",{className:`flex flex-shrink-0 items-center gap-2 bg-stone-100/80 rounded-full px-3 py-1.5 border border-stone-300 shadow-sm ${d?"justify-between w-full":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base select-none",children:"â±ï¸"}),e.jsx("button",{onClick:()=>A(!h),className:`px-2 py-0.5 rounded-full text-xs font-bold transition-all min-w-[2.5rem] border ${h?"bg-rose-500 text-white border-rose-600":"bg-white text-stone-600 border-stone-300 hover:bg-stone-50"}`,children:h?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center gap-1 border-l border-stone-300 pl-2",children:[e.jsx("input",{type:"number",min:"40",max:"200",value:o,onChange:u=>m(Number(u.target.value)),className:"w-12 px-1 py-0.5 text-center font-mono text-sm bg-white border border-stone-300 rounded focus:outline-none focus:ring-1 focus:ring-amber-400"}),e.jsx("span",{className:"text-[10px] font-bold text-stone-500",children:"BPM"})]})]}),e.jsxs("div",{className:`flex flex-shrink-0 items-center gap-2 bg-stone-100/80 rounded-full px-3 py-1.5 border border-stone-300 shadow-sm ${d?"justify-between w-full":""}`,children:[e.jsx("span",{className:"text-base select-none",children:"ðŸ”Š"}),e.jsx("div",{className:`flex flex-col justify-center ${d?"flex-1 mx-4":"w-24 sm:w-32"}`,children:e.jsx("input",{type:"range",min:"0",max:"100",value:w,onChange:u=>p(Number(u.target.value)),className:"w-full h-1.5 bg-stone-300 rounded-lg appearance-none cursor-pointer accent-stone-700 hover:accent-amber-600 transition-colors"})}),e.jsx("span",{className:"text-xs font-mono w-6 text-right text-stone-500",children:w})]})]});return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"hidden md:block",children:N(!1)}),e.jsx("div",{className:"md:hidden",children:e.jsx("button",{onClick:()=>b(!y),className:`p-2 rounded-full border shadow-sm transition-colors ${y?"bg-stone-200 border-stone-400 text-stone-800":"bg-stone-100 border-stone-300 text-stone-600 active:bg-stone-200"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})}),y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/5 md:hidden",onClick:()=>b(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-72 bg-white rounded-xl shadow-xl border border-stone-200 z-50 p-4 md:hidden animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b border-stone-100",children:[e.jsxs("span",{className:"font-bold text-stone-700 flex items-center gap-2",children:[e.jsx("span",{children:"âš™ï¸"})," è¨­å®š"]}),e.jsx("button",{onClick:()=>b(!1),className:"text-stone-400 hover:text-stone-600 p-1",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),N(!0)]})]})]})};function P(){const[c,a]=r.useState(null),[l,t]=r.useState(!1),[o,m]=r.useState(!0),[h,A]=r.useState(!0),i=T.useRef(null),w=T.useMemo(()=>{const n=[];return v.filter(f=>f.type===s.NATURAL).forEach(f=>{let j=null;const g=v.findIndex(k=>k.id===f.id);if(g!==-1&&g+1<v.length){const k=v[g+1];k.type===s.SHARP&&(j=k)}n.push({natural:f,sharp:j,index:g})}),n},[]),p=r.useCallback(n=>{C.playNote(n.frequency),a(n.id),setTimeout(()=>{a(x=>x===n.id?null:x)},150)},[]),y=r.useCallback(n=>{if(n.target instanceof HTMLInputElement)return;const x=n.key.toLowerCase(),f=v.find(j=>j.keyBind===x);f&&p(f)},[p]);r.useEffect(()=>(window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)),[y]);const b=r.useCallback((n,x)=>{const j=document.elementFromPoint(n,x)?.closest("[data-note-id]");if(j instanceof HTMLElement){const g=j.dataset.noteId;if(g&&g!==i.current){const k=v.find(B=>B.id===g);k&&(p(k),i.current=g)}}else i.current=null},[p]),N=r.useCallback(n=>{const x=n.touches[0];b(x.clientX,x.clientY)},[b]),d=r.useCallback(n=>{l&&b(n.clientX,n.clientY)},[l,b]),u=r.useCallback(()=>{i.current=null},[]);return e.jsxs("div",{className:"h-full w-full flex flex-col overflow-hidden select-none wood-bg",onMouseDown:()=>t(!0),onMouseUp:()=>{t(!1),i.current=null},onMouseLeave:()=>{t(!1),i.current=null},onContextMenu:n=>n.preventDefault(),children:[e.jsxs("div",{className:"flex-none bg-white/95 backdrop-blur shadow-lg z-[100] px-4 py-2 border-b border-stone-300 flex items-center justify-between relative",children:[e.jsxs("h1",{className:"text-lg sm:text-xl font-black text-stone-800 tracking-widest font-serif whitespace-nowrap flex items-center gap-2 pointer-events-none",children:[e.jsx("span",{className:"text-2xl",children:"ðŸŽ¹"})," æœ¨ç´ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼"]}),e.jsx("div",{className:"flex items-center justify-end z-10",children:e.jsx(S,{showNoteLabels:o,onToggleNoteLabels:m,showKeyLabels:h,onToggleKeyLabels:A})}),e.jsxs("div",{className:"absolute bottom-2 right-6 flex items-center gap-1 opacity-50",children:[e.jsx("div",{className:"w-8 h-1 bg-yellow-600 rounded-full"}),e.jsx("span",{className:"text-[#666] text-[10px] font-serif tracking-widest uppercase",children:"Orchestra Model"})]})]}),e.jsxs("div",{className:"flex-1 relative w-full overflow-hidden bg-[#1a1a1a] flex flex-col items-center justify-center p-0 sm:p-4 touch-none",onTouchStart:N,onTouchMove:N,onTouchEnd:u,onMouseMove:d,children:[e.jsx("div",{className:"fixed inset-0 opacity-30 pointer-events-none bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-stone-600 via-stone-900 to-black"}),e.jsx("div",{className:"w-full overflow-x-auto flex justify-start sm:justify-center px-4 no-scrollbar",children:e.jsx("div",{className:"relative min-w-fit mx-auto mt-4 sm:my-auto py-4 sm:py-8 scale-100 md:scale-110 xl:scale-125 origin-top sm:origin-center",children:e.jsxs("div",{className:"relative bg-[#111] px-2 sm:px-10 pb-8 rounded-lg shadow-[0_50px_100px_-20px_rgba(0,0,0,0.8)] border-t-2 border-[#333] inline-block",children:[e.jsx("div",{className:"absolute top-1/2 left-[-12px] bottom-0 w-4 bg-[#222] rounded-l border-r border-[#444] shadow-lg"}),e.jsx("div",{className:"absolute top-1/2 right-[-12px] bottom-0 w-4 bg-[#222] rounded-r border-l border-[#444] shadow-lg"}),e.jsxs("div",{className:"absolute top-8 left-6 right-6 bottom-8 bg-[#050505] opacity-100 z-0 rounded shadow-inner overflow-hidden border border-[#222]",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#050505] via-[#111] to-[#050505] opacity-70"}),e.jsx("div",{className:"absolute inset-x-0 top-0 h-4 bg-white opacity-5"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-4 bg-black opacity-5"})]}),e.jsx("div",{className:"relative z-10 flex justify-center items-end h-[26rem] sm:h-[28rem] pt-8 pb-4",onMouseLeave:()=>t(!1),children:w.map((n,x)=>e.jsxs("div",{className:"relative flex flex-col items-center group w-8 sm:w-10 md:w-12 lg:w-14",children:[e.jsx("div",{className:"h-[16rem] w-full relative z-20 pointer-events-none",children:n.sharp&&e.jsx("div",{className:"absolute left-[50%] translate-x-1/2 bottom-0 pointer-events-auto filter drop-shadow-xl transition-transform group-hover:translate-y-[1px]",children:e.jsx(R,{note:n.sharp,isActive:c===n.sharp.id,onPlay:p,index:n.index+1,totalNotes:v.length,showNoteLabels:o,showKeyLabels:h})})}),e.jsx("div",{className:"-mt-20 z-10 transition-transform group-hover:translate-y-[1px]",children:e.jsx(R,{note:n.natural,isActive:c===n.natural.id,onPlay:p,index:n.index,totalNotes:v.length,showNoteLabels:o,showKeyLabels:h})})]},n.natural.id))})]})})})]})]})}export{P as default};
